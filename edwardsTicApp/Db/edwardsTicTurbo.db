# edwardsTicTurbo.template
# Template database for for the Edwards TIC Turbo Instrument Controller
# Turbo Pump
# Pete Owens 30/1/2017
#
# substitutions:
# device  - device name
# port    - asyn port
#
################################################################################
# STA - Turbo Pump status
#
record(mbbi, "$(P)STA")
{
    field(DESC, "Pump status")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_sta($(P)STA) $(PORT)")
    field(SCAN, "1 second")
    field(ZRST, "Stopped")
    field(ONST, "Starting Delay")
    field(TWST, "Stopping Short Delay")
    field(THST, "Stopping Normal Delay")
    field(FRST, "Running")
    field(FVST, "Accelerating")
    field(SXST, "Fault Breaking")   field(SXSV, "MAJOR")
    field(SVST, "Braking")
    field(FLNK, "$(P)STA:ALERT")
}
record(longin, "$(P)STA:ALERT")
{
    field(FLNK, "$(P)STA:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)STA:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
# START - Start Turbo Pump
#
record(bo, "$(P)START")
{
    field(DESC, "Start Pump")
    field(DTYP, "stream")
    field(OUT,  "@edwardsTic.proto start_t $(PORT)")
    field(ZNAM, "Off")
    field(ONAM, "On")
}
################################################################################
# SPEED - Turbo Pump Speed
#
record(ai, "$(P)SPEED")
{
    field(DESC, "Speed")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_speed($(P)SPEED) $(PORT)")
    field(SCAN, "1 second")
    field(EGU,  "%")
    field(PREC, "1")
    field(LOPR, "0.0")
    field(HOPR, "110.0")
    field(HIGH, "110.0")
    field(LOW,  "0.0")
    field(HIHI, "110.1")
    field(LOLO, "-0.1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
    field(FLNK, "$(P)SPEED:ALERT")
}
record(longin, "$(P)SPEED:ALERT")
{
    field(FLNK, "$(P)SPEED:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)SPEED:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
# SRF - Turbo Pump Start/Droop Fail Time
#
record(longin, "$(P)SFT")
{
    field(DESC, "Start Fail Time")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_sft($(device)) $(PORT)")
    field(SCAN, "10 second")
    field(EGU,  "s")
    field(LOPR, "0")
    field(HOPR, "30")
    field(FLNK, "$(P)DFT")
}
record(longin, "$(P)DFT")
{
    field(DESC, "Droop Fail Time")
    field(EGU,  "s")
    field(LOPR, "0")
    field(HOPR, "30")
}
################################################################################
# SPEED - Turbo Pump Power
#
record(ai, "$(P)POWER")
{
    field(DESC, "Power")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_power($(P)POWER) $(PORT)")
    field(SCAN, "1 second")
    field(EGU,  "W")
    field(PREC, "1")
    field(LOPR, "0.0")
    field(HOPR, "300.0")
    field(HIGH, "300.0")
    field(LOW,  "0.0")
    field(HIHI, "300.1")
    field(LOLO, "-0.1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
    field(FLNK, "$(P)POWER:ALERT")
}
record(longin, "$(P)POWER:ALERT")
{
    field(FLNK, "$(P)POWER:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)POWER:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
# NORM - Turbo Pump at normal speed
#
record(bi, "$(P)NORM")
{
    field(DESC, "Normal Speed")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_norm($(P)NORM) $(PORT)")
    field(SCAN, "1 second")
    field(ZNAM, "No")
    field(ONAM, "Yes")
    field(OVAL, "4")
    field(FLNK, "$(P)NORM:ALERT")
}
record(longin, "$(P)NORM:ALERT")
{
    field(FLNK, "$(P)NORM:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)NORM:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
# STBY - Standby Mode
#
record(bi, "$(P)STBY")
{
    field(DESC, "Standby Mode")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_stby($(P)STBY) $(PORT)")
    field(SCAN, "1 second")
    field(ZNAM, "No")
    field(ONAM, "Yes")
    field(OVAL, "4")
    field(FLNK, "$(P)STBY:ALERT")
}
record(longin, "$(P)STBY:ALERT")
{
    field(FLNK, "$(P)STBY:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)STBY:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
# START - Set Standby Mode
#
record(bo, "$(P)SETSTBY")
{
    field(DESC, "Standby Mode")
    field(DTYP, "stream")
    field(OUT,  "@edwardsTic.proto set_t_stby $(PORT)")
    field(ZNAM, "No")
    field(ONAM, "Yes")
}
################################################################################
# CYCLE - Turbo Pump Cycle Time
#
record(longin, "$(P)CYCLE")
{
    field(DESC, "Cycle Tim")
    field(DTYP, "stream")
    field(INP,  "@edwardsTic.proto get_t_cycle($(P)CYCLE) $(PORT)")
    field(SCAN, "10 second")
    field(EGU,  "h")
    field(LOPR, "0")
    field(HOPR, "65535")
    field(FLNK, "$(P)CYCLE:STATE")
}
record(longin, "$(P)CYCLE:STATE")
{
     field(FLNK, "$(P)CYCLE:ALERT")
}
record(longin, "$(P)CYCLE:ALERT")
{
    field(FLNK, "$(P)CYCLE:PRI")
    field(HIGH, "1")
    field(LOW,  "-1")
    field(HIHI, "48")
    field(LOLO, "-1")
    field(HSV,  "MINOR")
    field(LSV,  "MINOR")
    field(HHSV, "MAJOR")
    field(LLSV, "MAJOR")
}
record(mbbi, "$(P)CYCLE:PRI")
{
    field(ZRST, "OK")
    field(ONST, "Warning") field(ONSV, "MINOR")
    field(TWST, "Alarm")   field(TWSV, "MINOR")
    field(THST, "Alarm")   field(THSV, "MAJOR")
}
################################################################################
